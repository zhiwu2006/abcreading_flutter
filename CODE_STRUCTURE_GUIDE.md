# ä»£ç ç»“æ„å¿«é€Ÿå®šä½æŒ‡å—

## ğŸ¯ ç›®çš„

è¿™ä¸ªæ–‡æ¡£å¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®šä½ä»£ç ä¸­çš„ç‰¹å®šåŠŸèƒ½å’Œç»„ä»¶ï¼Œé¿å…åœ¨å¤§å‹æ–‡ä»¶ä¸­èŠ±è´¹è¿‡å¤šæ—¶é—´æœç´¢ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„æ¦‚è§ˆ

```
lib/
â”œâ”€â”€ main.dart                           # ä¸»åº”ç”¨å…¥å£ (2900+ è¡Œ)
â”œâ”€â”€ models/                             # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ lesson.dart                     # è¯¾ç¨‹æ•°æ®æ¨¡å‹
â”œâ”€â”€ services/                           # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ lesson_manager_service.dart     # è¯¾ç¨‹ç®¡ç†æœåŠ¡
â”‚   â”œâ”€â”€ tts_service.dart               # è¯­éŸ³æœ—è¯»æœåŠ¡
â”‚   â””â”€â”€ supabase_service.dart          # æ•°æ®åº“æœåŠ¡
â”œâ”€â”€ presentation/                       # è¡¨ç°å±‚
â”‚   â”œâ”€â”€ pages/                         # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ lesson_editor_page.dart    # è¯¾ç¨‹ç¼–è¾‘å™¨
â”‚   â”‚   â””â”€â”€ lesson_detail_editor_page.dart # è¯¾ç¨‹è¯¦æƒ…ç¼–è¾‘
â”‚   â””â”€â”€ widgets/                       # å¯å¤ç”¨ç»„ä»¶
â””â”€â”€ data/                              # æ•°æ®å±‚
    â””â”€â”€ default_lessons.dart           # é»˜è®¤è¯¾ç¨‹æ•°æ®
```

## ğŸ” main.dart æ–‡ä»¶ç»“æ„ (å…³é”®å®šä½)

### åº”ç”¨å…¥å£å’Œé…ç½® (1-100è¡Œ)
```dart
// åº”ç”¨å¯åŠ¨å’Œåˆå§‹åŒ–
void main() async                       // ç¬¬33è¡Œ
class EnglishLearningApp               // ç¬¬70è¡Œ
class ReadingPreferences               // ç¬¬95è¡Œ
```

### ä¸»é¡µé¢ç»„ä»¶ (100-600è¡Œ)
```dart
class HomePage extends StatefulWidget   // ç¬¬120è¡Œ
class _HomePageState                   // ç¬¬126è¡Œ
  - _initApp()                         // ç¬¬150è¡Œ - åº”ç”¨åˆå§‹åŒ–
  - _loadProgress()                    // ç¬¬160è¡Œ - åŠ è½½å­¦ä¹ è¿›åº¦
  - _saveProgress()                    // ç¬¬180è¡Œ - ä¿å­˜å­¦ä¹ è¿›åº¦
```

### ä¾§è¾¹æ å’Œè®¾ç½® (600-1200è¡Œ)
```dart
_buildDrawer()                         // ç¬¬400è¡Œ - ä¾§è¾¹æ æ„å»º
_buildLessonSelector()                 // ç¬¬600è¡Œ - è¯¾ç¨‹é€‰æ‹©å™¨
class ReadingSettings                  // ç¬¬800è¡Œ - é˜…è¯»è®¾ç½®ç»„ä»¶
  - _buildFontSizeSettings()           // ç¬¬900è¡Œ - å­—ä½“å¤§å°è®¾ç½®
  - _buildFontFamilySettings()         // ç¬¬950è¡Œ - å­—ä½“æ ·å¼è®¾ç½®
```

### è¯¾ç¨‹å†…å®¹ç»„ä»¶ (1200-2600è¡Œ)
```dart
class LessonContent                    // ç¬¬1200è¡Œ - è¯¾ç¨‹å†…å®¹ä¸»ç»„ä»¶
class _LessonContentState              // ç¬¬1220è¡Œ
  - _buildStoryTab()                   // ç¬¬1400è¡Œ - æ•…äº‹é˜…è¯»æ ‡ç­¾é¡µ
  - _showFullScreenReading()           // ç¬¬1500è¡Œ - ğŸ¯ å…¨å±é˜…è¯»åŠŸèƒ½
  - _buildClickableContent()           // ç¬¬1600è¡Œ - å¯ç‚¹å‡»æ–‡æœ¬å†…å®¹
  - _buildClickableParagraph()         // ç¬¬1700è¡Œ - ğŸ¯ å•è¯ç‚¹å‡»å¤„ç†
  - _buildVocabularyTab()              // ç¬¬1900è¡Œ - è¯æ±‡å­¦ä¹ æ ‡ç­¾é¡µ
  - _buildSentencesTab()               // ç¬¬2100è¡Œ - é‡ç‚¹å¥å­æ ‡ç­¾é¡µ
  - _buildQuizTab()                    // ç¬¬2300è¡Œ - ç»ƒä¹ é¢˜æ ‡ç­¾é¡µ
```

### è¾…åŠ©æ–¹æ³• (2600-2900è¡Œ)
```dart
// è¯­éŸ³å’Œäº¤äº’æ–¹æ³•
_speakFullStory()                      // ç¬¬2630è¡Œ - æœ—è¯»å…¨æ–‡
_speakWord()                           // ç¬¬2635è¡Œ - æœ—è¯»å•è¯
_showWordMeaning()                     // ç¬¬2640è¡Œ - ğŸ¯ å•è¯é‡Šä¹‰å¼¹çª—
_showWordLookupDialog()                // ç¬¬2750è¡Œ - ğŸ¯ åœ¨çº¿æŸ¥è¯å¯¹è¯æ¡†
_openOnlineDictionary()                // ç¬¬2850è¡Œ - ğŸ¯ æ‰“å¼€åœ¨çº¿è¯å…¸

// æµ‹è¯•å’Œäº¤äº’æ–¹æ³•
_submitQuiz()                          // ç¬¬2900è¡Œ - æäº¤æµ‹è¯•ç­”æ¡ˆ
_resetQuiz()                           // ç¬¬2950è¡Œ - é‡ç½®æµ‹è¯•
```

## ğŸ¨ UI æ ·å¼å’Œä¸»é¢˜å®šä½

### é¢œè‰²ä¸»é¢˜
```dart
// ä¸»è¦é¢œè‰² (ç¬¬80-90è¡Œ)
primarySwatch: Colors.blue
seedColor: Color(0xFF3B82F6)          // ä¸»è“è‰²

// AppBar é¢œè‰² (ç¬¬400è¡Œå·¦å³)
backgroundColor: Color(0xFF3B82F6)     // æ ‡é¢˜æ èƒŒæ™¯

// å…¨å±é˜…è¯»èƒŒæ™¯ (ç¬¬1550è¡Œå·¦å³) ğŸ¯
color: Colors.white                    // ç™½è‰²èƒŒæ™¯ (å·²ä¿®æ”¹)
// ä¹‹å‰æ˜¯: Color(0xFFF5ECD8)          // Sepia æŠ¤çœ¼è‰²

// å¡ç‰‡å’Œå®¹å™¨èƒŒæ™¯
Color(0xFFF8FAFC)                     // æµ…ç°èƒŒæ™¯
Colors.blue[50]                       // æµ…è“èƒŒæ™¯
Colors.green[50]                      // æµ…ç»¿èƒŒæ™¯
```

### å­—ä½“è®¾ç½®
```dart
// é»˜è®¤å­—ä½“ (ç¬¬85è¡Œ)
fontFamily: 'TimesNewRoman'

// å­—ä½“å¤§å°è®¾ç½® (ç¬¬900è¡Œå·¦å³)
fontSize: readingPreferences.fontSize.toDouble()
```

## ğŸ”§ åŠŸèƒ½æ¨¡å—å¿«é€Ÿå®šä½

### ğŸ“– é˜…è¯»ç›¸å…³åŠŸèƒ½
| åŠŸèƒ½ | ä½ç½® | å…³é”®æ–¹æ³• |
|------|------|----------|
| å…¨å±é˜…è¯» | 1500-1600è¡Œ | `_showFullScreenReading()` |
| å•è¯ç‚¹å‡» | 1700-1800è¡Œ | `_buildClickableParagraph()` |
| å•è¯é•¿æŒ‰é‡Šä¹‰ | 2640-2750è¡Œ | `_showWordMeaning()` |
| åœ¨çº¿æŸ¥è¯ | 2750-2900è¡Œ | `_showWordLookupDialog()` |
| è¯æ±‡é«˜äº® | 1800-1900è¡Œ | `_buildVocabularyHighlightSection()` |

### ğŸµ è¯­éŸ³åŠŸèƒ½
| åŠŸèƒ½ | ä½ç½® | å…³é”®æ–¹æ³• |
|------|------|----------|
| æœ—è¯»å…¨æ–‡ | 2630è¡Œ | `_speakFullStory()` |
| æœ—è¯»å•è¯ | 2635è¡Œ | `_speakWord()` |
| æœ—è¯»è¯æ±‡ | 2760è¡Œ | `_speakVocabulary()` |

### ğŸ“ æµ‹è¯•åŠŸèƒ½
| åŠŸèƒ½ | ä½ç½® | å…³é”®æ–¹æ³• |
|------|------|----------|
| ç»ƒä¹ é¢˜æ˜¾ç¤º | 2300-2500è¡Œ | `_buildQuizTab()` |
| æäº¤ç­”æ¡ˆ | 2900è¡Œ | `_submitQuiz()` |
| é‡ç½®æµ‹è¯• | 2950è¡Œ | `_resetQuiz()` |

### âš™ï¸ è®¾ç½®åŠŸèƒ½
| åŠŸèƒ½ | ä½ç½® | å…³é”®æ–¹æ³• |
|------|------|----------|
| å­—ä½“å¤§å° | 900-950è¡Œ | `_buildFontSizeSettings()` |
| å­—ä½“æ ·å¼ | 950-1000è¡Œ | `_buildFontFamilySettings()` |
| è¯æ±‡é«˜äº® | 1000-1050è¡Œ | `_buildVocabularyHighlightSettings()` |

## ğŸ” å¿«é€Ÿæœç´¢æŠ€å·§

### æŒ‰åŠŸèƒ½æœç´¢
```bash
# æœç´¢å…¨å±ç›¸å…³
grep -n "fullscreen\|å…¨å±\|FullScreen" lib/main.dart

# æœç´¢é¢œè‰²ç›¸å…³
grep -n "Color\|backgroundColor\|color:" lib/main.dart

# æœç´¢å­—ä½“ç›¸å…³
grep -n "fontSize\|fontFamily\|TextStyle" lib/main.dart

# æœç´¢å•è¯ç‚¹å‡»ç›¸å…³
grep -n "GestureDetector\|onTap\|onLongPress" lib/main.dart
```

### æŒ‰ç»„ä»¶æœç´¢
```bash
# æœç´¢ç‰¹å®šç»„ä»¶
grep -n "class.*Widget\|Widget.*build" lib/main.dart

# æœç´¢æ–¹æ³•å®šä¹‰
grep -n "void _\|Future<.*> _" lib/main.dart

# æœç´¢çŠ¶æ€ç®¡ç†
grep -n "setState\|State<" lib/main.dart
```

## ğŸ“‹ å¸¸è§ä¿®æ”¹åœºæ™¯

### ğŸ¨ UI æ ·å¼ä¿®æ”¹
1. **ä¿®æ”¹ä¸»é¢˜é¢œè‰²**: æœç´¢ `Color(0xFF` æˆ– `Colors.blue`
2. **ä¿®æ”¹å­—ä½“å¤§å°**: æœç´¢ `fontSize` æˆ– `readingPreferences.fontSize`
3. **ä¿®æ”¹èƒŒæ™¯è‰²**: æœç´¢ `backgroundColor` æˆ– `color:`
4. **ä¿®æ”¹åœ†è§’**: æœç´¢ `BorderRadius.circular`

### ğŸ”§ åŠŸèƒ½ä¿®æ”¹
1. **ä¿®æ”¹å•è¯ç‚¹å‡»**: å®šä½åˆ° `_buildClickableParagraph()` (1700è¡Œ)
2. **ä¿®æ”¹å…¨å±é˜…è¯»**: å®šä½åˆ° `_showFullScreenReading()` (1500è¡Œ)
3. **ä¿®æ”¹è¯­éŸ³åŠŸèƒ½**: æœç´¢ `ttsService` æˆ– `_speak`
4. **ä¿®æ”¹æµ‹è¯•é€»è¾‘**: å®šä½åˆ° `_submitQuiz()` (2900è¡Œ)

### ğŸ“± äº¤äº’ä¿®æ”¹
1. **ä¿®æ”¹æ‰‹åŠ¿**: æœç´¢ `GestureDetector` æˆ– `onTap`
2. **ä¿®æ”¹å¯¹è¯æ¡†**: æœç´¢ `showDialog` æˆ– `AlertDialog`
3. **ä¿®æ”¹å¯¼èˆª**: æœç´¢ `Navigator` æˆ– `MaterialPageRoute`
4. **ä¿®æ”¹æç¤º**: æœç´¢ `SnackBar` æˆ– `ScaffoldMessenger`

## ğŸš€ å¼€å‘æ•ˆç‡æå‡å»ºè®®

### 1. ä»£ç åˆ†å‰²
- **å»ºè®®**: å°† main.dart æ‹†åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶
- **ä¼˜å…ˆçº§**: é«˜
- **å®æ–½**: æå– LessonContent ä¸ºç‹¬ç«‹ç»„ä»¶

### 2. æ·»åŠ ä»£ç æ³¨é‡Š
- **å»ºè®®**: ä¸ºå…³é”®æ–¹æ³•æ·»åŠ è¯¦ç»†æ³¨é‡Š
- **ä¼˜å…ˆçº§**: ä¸­
- **å®æ–½**: æ ‡è®°åŠŸèƒ½åŒºåŸŸå’Œé‡è¦é€»è¾‘

### 3. åˆ›å»ºå¸¸é‡æ–‡ä»¶
- **å»ºè®®**: æå–é¢œè‰²ã€å­—ä½“ç­‰å¸¸é‡
- **ä¼˜å…ˆçº§**: ä¸­
- **å®æ–½**: åˆ›å»º constants.dart æ–‡ä»¶

### 4. ä½¿ç”¨ä»£ç æŠ˜å 
- **å»ºè®®**: åœ¨ IDE ä¸­ä½¿ç”¨ä»£ç æŠ˜å åŠŸèƒ½
- **ä¼˜å…ˆçº§**: ä½
- **å®æ–½**: æ·»åŠ  `// region` æ³¨é‡Š

## ğŸ“ ç»´æŠ¤æ¸…å•

### å®šæœŸæ›´æ–° (æ¯æ¬¡é‡å¤§ä¿®æ”¹å)
- [ ] æ›´æ–°è¡Œå·å¼•ç”¨
- [ ] æ·»åŠ æ–°åŠŸèƒ½çš„å®šä½ä¿¡æ¯
- [ ] æ£€æŸ¥æœç´¢å…³é”®è¯çš„æœ‰æ•ˆæ€§
- [ ] æ›´æ–°å¸¸è§ä¿®æ”¹åœºæ™¯

### ä»£ç é‡æ„æ—¶
- [ ] æ›´æ–°æ–‡ä»¶ç»“æ„å›¾
- [ ] é‡æ–°æ ‡è®°å…³é”®æ–¹æ³•ä½ç½®
- [ ] æ›´æ–°æœç´¢æŠ€å·§
- [ ] éªŒè¯å¿«é€Ÿå®šä½çš„å‡†ç¡®æ€§

---

**æœ€åæ›´æ–°**: 2025å¹´1æœˆ
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ
**ç‰ˆæœ¬**: v0.4.0-dev
## ğŸ¨
 UIä¼˜åŒ–è®°å½•

### TabBarå“åº”å¼ä¼˜åŒ– (v0.3.1)
**ä½ç½®**: ç¬¬2640-2700è¡Œ
**æ–¹æ³•**: `_buildCompactTab(IconData icon, String text)`

**åŠŸèƒ½ç‰¹ç‚¹**:
- å“åº”å¼å¸ƒå±€ï¼šæ ¹æ®å±å¹•å®½åº¦è‡ªåŠ¨è°ƒæ•´æ˜¾ç¤ºæ¨¡å¼
- é«˜åº¦ä¼˜åŒ–ï¼šä»48pxç¼©å‡åˆ°40pxï¼ŒèŠ‚çœ17%ç©ºé—´
- ä¸‰ç§æ˜¾ç¤ºæ¨¡å¼ï¼š
  - è¶…çª„å±ï¼šä»…å›¾æ ‡
  - çª„å±ï¼šå›¾æ ‡+ç®€åŒ–æ–‡å­—
  - å®½å±ï¼šå›¾æ ‡+å®Œæ•´æ–‡å­—

**æœç´¢å…³é”®è¯**: `COMPACT_TAB`, `å“åº”å¼æ ‡ç­¾`, `_buildCompactTab`

**ä½¿ç”¨ä½ç½®**: ç¬¬1715è¡ŒTabBarç»„ä»¶ä¸­

### ç¦»çº¿å­—å…¸åŠŸèƒ½ (v0.3.1)
**ä½ç½®**: `lib/services/dictionary_service.dart`
**æ–¹æ³•**: `DictionaryService.lookupWord(String word)`

**åŠŸèƒ½ç‰¹ç‚¹**:
- åŸºäºOxford 3000å’ŒCET-4/6è¯æ±‡
- æ”¯æŒè¯å½¢å˜åŒ–åŒ¹é…ï¼ˆå¤æ•°ã€è¿‡å»å¼ã€è¿›è¡Œæ—¶ç­‰ï¼‰
- åŒ…å«éŸ³æ ‡ã€ä¸­æ–‡é‡Šä¹‰ã€è¯æ€§ã€å­¦ä¹ æ ‡ç­¾
- å®Œå…¨ç¦»çº¿ï¼Œæ— ç½‘ç»œä¾èµ–

**æœç´¢å…³é”®è¯**: `DICTIONARY`, `ç¦»çº¿å­—å…¸`, `DictionaryService`

**é›†æˆä½ç½®**: ç¬¬2680è¡Œ `_showWordMeaning` æ–¹æ³•ä¸­